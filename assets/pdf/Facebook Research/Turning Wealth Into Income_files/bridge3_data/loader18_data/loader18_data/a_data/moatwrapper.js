/*Copyright (c) 2011, 2020, Oracle and/or its affiliates.  All rights reserved.*/


!function(){try{!function(d,m){window.getVPAIDAd=function(){if(S.ad)return S.ad;var e=function(){S.Util=n(),S.Queue=s(),S.VpaidAd=o(),S.MoatTag=a(),r();var e=S.Util.parseQS();if(e){S.qs=e;var t={};for(var i in e)t[i]=e[i];return t.wrapperType="js",new S.MoatTag(S.qs.pcode,t),new S.VpaidAd}}();return S.ad=e};function T(){function e(){this.availableResources=["StaticResource","IFrameResource","HTMLResource"],this.availableTypesMap={"image/gif":"img","image/jpeg":"img","image/png":"img","application/x-javascript":"js","application/x-shockwave-flash":"swf"},this.availableTypes=["swf","img"]}return e.prototype.loadCompanion=function(r,a,o,s,d,e,l,u){var h=this;function c(e,t,i,n,r,a,o,s){s=s||[];for(var d,l,u="",c=0;c<s.length;c++)u+='<img src="'+s[c]+'" style="display:none" width="1" height="1">';return"StaticResource"===r&&("img"==a&&(d='<img src="'+t+'" width="'+i+'" height="'+n+'">',u+=o?'<a href="'+o+'" target="_blank">'+d+"</a>":d),"swf"==a&&(u+='<object type="application/x-shockwave-flash" classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="http://download.macromedia.com/pub/sho ckwave/cabs/flash/swflash.cab#version=8,0,0,0" width="'+i+'" height="'+n+'" id="companion'+((l=m.floor(1e7*m.random()))-1)+'"><param name="allowScriptAccess" value="always" /><param name= "movie" value="'+t+'" />'+(o?'<param name="FlashVars" value="clickTag='+encodeURIComponent(o)+'" />':"")+'<param name="wmode" value="opaque" /><embed type="application/x-shockwave-flash" src="'+t+'" '+(o?'flashvars="clickTag='+encodeURIComponent(o)+'" ':"")+'wmode="opaque" width="'+i+'" height="'+n+'" id="companion'+l+'"name="companion'+l+'"allowscriptaccess="always" /></object>')),"IFrameResource"===r&&(u+="<iframe style='border:0px; padding:0px; margin:0px;' width='"+i+"' height='"+n+"' frameborder='no' scrolling='no' marginheight='0' marginwidth='0' src='"+t+"'></iframe>"),"HTMLResource"===r&&(u+=t,e&&(i&&(e.style.width=i+"px"),n&&(e.style.height=n+"px"))),u}a=h.availableTypesMap[a];var p=!1;function t(){if(p)return!0;try{var e=a,t=function(e,t,n,r){var i,l="moatCompanionDiv_"+e+"x"+t;function a(e){var t=[],i=e.getElementById(l);i&&t.push(i);for(var n,r=0,a=h.availableResources.length;r<a;r++){if("StaticResource"==h.availableResources[r])for(var o=0,s=h.availableTypes.length;o<s;o++){var d=e.getElementById(l+"_"+h.availableResources[r]+"_"+h.availableTypes[o]);d&&t.push(d)}else n=e.getElementById(l+"_"+h.availableResources[r]);n&&t.push(n)}return 0<t.length&&t}function o(e){if(!e||0==e.length)return!1;if(1==e.length)return e[0];for(var t=0,i=e.length;t<i;t++)if(r){if(e[t].id===l+"_"+n+"_"+r)return e[t]}else if(e[t].id===l+"_"+n)return e[t];return!1}try{i=o(a(document))||o(a(window.top.document))}catch(e){}if(i)return i;var s=[];try{for(var d=window.frames,u=0,c=d.length;u<c;u++){try{var p=a(d[u].document)}catch(e){}p&&(s=s.concat(p))}}catch(e){}return(i=o(s))||!1}(o,s,r,e);if(!t)return!1;if("DIV"!==t.nodeName){var i=t;i.id="";var n=S.Util.getParentNode(i);if(!n)return!1;t=document.createElement("div"),S.Util.addTagSafely(t,n)}else t.id="";t.innerHTML=c(t,d,o,s,r,e,l,u)}catch(e){return!1}return!0}var i,n,v,f=t();return f||(setTimeout(function(){!function e(t,i,n,r){r<=n||t()||(n++,setTimeout(function(){e(t,i,n,r)},i))}(t,500,0,10)},500),i=window,n="message",v=function(e){var t,i,n;p||"string"==typeof e.data&&(t=e.data.match(/^zMoatPlaceholder#([0-9]+)x([0-9]+)$/))&&(i=t[1],n=t[2],i==o&&n==s&&(p=function(e){try{var t=c(null,d,o,s,r,a,l,u);e.postMessage("zMoatAdContent#"+t,"*")}catch(e){return!1}return!0}(e.source)))},i.addEventListener?i.addEventListener(n,v,!1):i.attachEvent("on"+n,v)),f},e}function t(){function e(e){this.skipContainer,this.textContainer,this.iconContainer,this.skipIconUrl="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAABGdBTUEAALGPC/xhBQAAAKBJREFUOBFjYBgFsBD4////TCBmg/Hx0UB1FUD8CYi7cKoDSoLAMSCWxKkIKgFU8xSkGAh+4VQLkQeTz4CkJU6FQAmg/CuYepzqYAqg9E8gnYZLMVCOZANh5mMNV0oMBBmMEa6UGggyFCVckQ1kwhUuVBcHOQMHoKqXqRYpVE02KBGALWyBQUN0OsQILxwGEpX1sIYXDgNhhUM3NvlhLgYAYuCVi7Jf+AUAAAAASUVORK5CYII=",this.init(e)}return e.prototype.init=function(e){this.createContainer(),this.createTextContainer(),this.createIconContainer(),e.appendChild(this.skipContainer),this.updateButtonTextSubscription=S.Queue.subscribe("skip-button",this.updateButtonText.bind(this)),S.Queue.subscribe("vpaid-events",this.addClickHandler.bind(this))},e.prototype.createContainer=function(){this.skipContainer=document.createElement("div"),this.skipContainer.style.background="rgba(0,0,0,0.8)",this.skipContainer.style.color="#ffffff",this.skipContainer.style.fontSize="11px",this.skipContainer.style.fontFamily="arial,sans-serif",this.skipContainer.style.position="absolute",this.skipContainer.style.textAlign="center",this.skipContainer.style.right="0px",this.skipContainer.style.bottom="10%",this.skipContainer.style.padding="2%",this.skipContainer.style.cursor="default",S.Util.addListener(this.skipContainer,"click",this.stopEventPropagation,"stopEvtPropagationFn")},e.prototype.createTextContainer=function(){this.textContainer=document.createElement("span"),this.textContainer.style.verticalAlign="middle",this.skipContainer.appendChild(this.textContainer)},e.prototype.createIconContainer=function(){this.iconContainer=document.createElement("img"),this.iconContainer.style.display="none",this.iconContainer.style.verticalAlign="middle",this.iconContainer.setAttribute("src",this.skipIconUrl),this.skipContainer.appendChild(this.iconContainer)},e.prototype.updateButtonText=function(e){0<e.timeLeft?this.textContainer.innerHTML="you can skip this ad in "+e.timeLeft:(this.textContainer.innerHTML="Skip Ad",this.textContainer.style.fontSize="18px",this.iconContainer.style.display="inline",this.updateButtonTextSubscription.remove(),this.skipContainer.style.cursor="pointer")},e.prototype.skipAd=function(){S.underlyingAsset&&S.underlyingAsset.skipAd()},e.prototype.addClickHandler=function(e){e.type===S.VPAIDevents.AdSkippableStateChange&&(S.Util.addListener(this.skipContainer,"click",this.skipAd,"skipClickHandlerFn"),S.Util.removeListener(this.skipContainer,"click",this.stopEventPropagation,"stopEvtPropagationFn"))},e.prototype.stopEventPropagation=function(e){"function"==typeof e.stopPropagation&&e.stopPropagation()},e.prototype.cleanUp=function(){this.skipContainer.parentNode.removeChild(this.skipContainer),this.skipContainer=null,this.textContainer=null,this.iconContainer=null},e}var S={ad:null,version:"2.0",startTime:(new d).getTime(),playerProvidedEventCallbacks:{},VPAIDevents:{AdLoaded:"AdLoaded",AdStarted:"AdStarted",AdStopped:"AdStopped",AdSkipped:"AdSkipped",AdSkippableStateChange:"AdSkippableStateChange",AdSizeChange:"AdSizeChange",AdLinearChange:"AdLinearChange",AdDurationChange:"AdDurationChange",AdExpandedChange:"AdExpandedChange",AdRemainingTimeChange:"AdRemainingTimeChange",AdVolumeChange:"AdVolumeChange",AdImpression:"AdImpression",AdVideoStart:"AdVideoStart",AdVideoFirstQuartile:"AdVideoFirstQuartile",AdVideoMidpoint:"AdVideoMidpoint",AdVideoThirdQuartile:"AdVideoThirdQuartile",AdVideoComplete:"AdVideoComplete",AdClickThru:"AdClickThru",AdInteraction:"AdInteraction",AdUserAcceptInvitation:"AdUserAcceptInvitation",AdUserMinimize:"AdUserMinimize",AdUserClose:"AdUserClose",AdPaused:"AdPaused",AdPlaying:"AdPlaying",AdLog:"AdLog",AdError:"AdError",AdProgress:"AdProgress"},VPAIDmethods:{resizeAd:"resizeAd",startAd:"startAd",stopAd:"stopAd",pauseAd:"pauseAd",resumeAd:"resumeAd",expandAd:"expandAd",collapseAd:"collapseAd",skipAd:"skipAd"}},n=function(){var o={safeCallbacks:{},findMoatScript:function(){for(var e=/moatwrapper/,t=document.getElementsByTagName("script"),i=t.length-1;0<=i;i--){var n=t[i];if(e.test(n.src))return n}},parseQS:function(){var e={},t=o.findMoatScript();if(!t)return!1;for(var i=t.src.split("#")[1].split("&"),n=i.length-1;0<=n;n--){var r=i[n].split("=");e[r[0]]=decodeURIComponent(r.slice(1).join("="))}return e.vast&&(e.vast=o.expandCachebuster(e.vast)),e},getScrUrls:function(){var e,t=S&&S.qs,i=[],n=new RegExp(/^scr\d{1,}/);if(!t)return i;for(var r in t)0===r.search(n)&&"string"==typeof(e=t[r])&&i.push(e);return i},getParentNode:function(e){return e.parentNode||e.parentElement||!1},getElementNodeTree:function(e){if(!e)return!1;for(var t,i="number"==typeof cap?cap:50,n=[e],r=0;r<i&&((t=o.getParentNode(e))&&1===t);r++)e=t,n.push(e)},getSafeNode:function(e){if(!e)return!1;if("OBJECT"!==e.nodeName&&"EMBED"!==e.nodeName)return e;for(var t=o.getElementNodeTree(e),i=!1,n=0;n<t.length;n++){var r=t[n];if(r&&"OBJECT"!==r.nodeName&&"EMBED"!==r.nodeName){i=r;break}}return i},hasChildNodes:function(e){return e&&e.childNodes&&0<e.childNodes.length},addTagSafely:function(e,t){if(!e||!t)return!1;var i,n=o.getSafeNode(t);return!!n&&(o.hasChildNodes(n)?(i=n.childNodes[m.max(0,n.childNodes.length-1)]||null,n.insertBefore(e,i)):n.appendChild(e),n)},addScriptToDOM:function(e,t,i){if("string"!=typeof e||!t||!document)return!1;var n=i||document.createElement("script");n.type="text/javascript";var r=o.addTagSafely(n,t);return!!r&&(n.src=e,r)},isANumber:function(e){return"number"==typeof e&&!isNaN(e)},expandCachebuster:function(e){return e.replace("[MOAT_CB]",""+(new d).getTime())},createXMLcompanionNode:function(e){if(!e||0===e.length)return"";for(var t,i,n,r,a,o,s,d,l=document.implementation.createDocument(null,"CompanionAds",null),u=e.length-1;0<=u;u--){if(t=e[u],(i=l.createElementNS("","Companion")).setAttributeNS("","width",t.width),i.setAttributeNS("","height",t.height),(n=l.createElementNS("","StaticResource")).setAttributeNS("","type",t.type),n.appendChild(l.createCDATASection(t.staticResource)),i.appendChild(n),t.companionClickThroughURLTemplate&&((r=l.createElementNS("","CompanionClickThrough")).appendChild(l.createCDATASection(t.companionClickThroughURLTemplate)),i.appendChild(r)),t.trackingEvents&&t.trackingEvents.creativeView){a=l.createElementNS("","TrackingEvents");for(var c=(o=t.trackingEvents.creativeView).length-1;0<=c;c--)s=o[c],(d=l.createElementNS("","Tracking")).setAttributeNS("","event","creativeView"),d.appendChild(l.createCDATASection(s)),a.appendChild(d);i.appendChild(a)}l.documentElement.appendChild(i)}return(new XMLSerializer).serializeToString(l)},emptyObj:{},isArray:function(e){try{return"[object Array]"===o.emptyObj.toString.call(e)}catch(e){return!1}},indexOf:function(e,t){if(!e)return-1;if(o.isArray(e)){for(var i=0,n=e.length;i<n;i++)if(e[i]===t)return i;return-1}return"string"==typeof e&&(t||"string"!=typeof t)?e.indexOf(t):-1},arrayContains:function(e,t){return-1!==o.indexOf(e,t)},isFunction:function(e){try{return"[object Function]"===o.emptyObj.toString.call(e)}catch(e){return!1}},isNumber:function(e){try{return"[object Number]"===o.emptyObj.toString.call(e)}catch(e){return!1}},timeouts:[],loops:{},makeSafe:function(e,a,o){var s=!1;return function(){try{return a?o?e.apply(o,arguments):e.apply(this,arguments):e.apply(null,arguments)}catch(e){if(!s){s=!0;var t,i,n=e.name+" in makeSafe: "+e.message+", stack="+e.stack;try{t=S.qs.level1+"%3A"+S.qs.level2+"%3A"+S.qs.level3+"%3A"+S.qs.level4}catch(e){t="data%3Adata%3Adata%3Adata"}try{i=S.qs.vast}catch(e){i="-"}i=i&&i.replace(/gdpr_consent=[^&]*&?/i,"");var r="//px.moatads.com/pixel.gif?e=24&d="+t+"&i="+encodeURIComponent("SPECTRUMREACHVPAID1")+"&ac=1&k="+encodeURIComponent(n)+"&ar="+encodeURIComponent("97b82f9bf7-clean")+"&iw="+encodeURIComponent("eefd067")+"&j="+encodeURIComponent(document.referrer)+"&zMoatVast="+encodeURIComponent(i)+"&cs="+(new d).getTime();(new Image).src=r,S.Queue.publish("vpaid-events",{type:S.VPAIDevents.AdError,args:["AdError"]})}}}},setSafeTimeout:function(e,t){var i;return e=o.makeSafe(e),window&&window.setTimeout&&(i=window.setTimeout(e,t),o.timeouts.push(i)),i},setSafeLoop:function(e,t,i){var n;o.isFunction(e)&&o.isArray(t)&&o.isNumber(i)&&(n=(new d).getTime()+"",o.loops[n]&&window.clearTimeout(o.loops[n].tid),o.loops[n]={},o.loops[n].callback=o.makeSafe(e,t),o.loops[n].interval=i,o.loops[n].tid=o.setSafeTimeout(o.runLoop(n),i),n=i=t=e=null)},runLoop:function(t){return function(){if(!o.loops||!o.loops[t])return!1;var e=o.loops[t].callback.call(null);if("boolean"==typeof e&&!1===e)return window.clearTimeout(o.loops[t].tid),o.loops[t]=!1;o.loops[t].tid=o.setSafeTimeout(o.runLoop(t),o.loops[t].interval),t=e=null}},objectToQueryString:function(e){var t,i,n=[];for(var r in e){e.hasOwnProperty(r)&&(t=e[r],i=r+"="+encodeURIComponent(t),n.push(i))}return n.join("&")},addListener:function(e,t,i,n){var r=this.makeSafe(i),a=e.addEventListener?{name:"addEventListener",evtPrefix:""}:{name:"attachEvent",evtPrefix:"on"};if(e&&a.name&&e[a.name])try{e[a.name](a.evtPrefix+t,r,!1)}catch(e){}!1!==n&&(o.safeCallbacks[t+n]=r)},removeListener:function(e,t,i,n){var r,a=t+n;if(!e)return delete o.safeCallbacks[a],!1;try{e.removeEventListener,e.detachEvent}catch(e){return delete o.safeCallbacks[a],!1}i=!1!==n?o.safeCallbacks[a]:i,r=e.removeEventListener?{name:"removeEventListener",evtPrefix:""}:{name:"detachEvent",evtPrefix:"on"};try{e[r.name](r.evtPrefix+t,i,!1)}catch(e){}delete o.safeCallbacks[a]},getDocAndWinOfEl:function(e){var t,i;try{i=(t=e.ownerDocument)&&(t.defaultView||t.parentWindow)}catch(e){}return{elDoc:t,elWin:i}},isPromise:function(e){return!!e&&"function"==typeof e.then&&"function"==typeof e.catch},isANumber:function(e){return"number"==typeof e&&!isNaN(e)}};return o},r=function(){S.Queue.subscribe("vpaid-events",function(e){var t=e.type,i=e.args;if(S.playerProvidedEventCallbacks[t])for(var n=S.playerProvidedEventCallbacks[t],r=n.length-1;0<=r;r--){var a=n[r],o=a.fn,s=(s=a.listenerScope)||null;try{o.apply(s,i)}catch(e){}}})},a=function(){function e(e,t){(S.moatTag=this).pcode=e,this.ids=t,this.moatapi,this.eventBuffer=[],this.init()}return e.prototype.init=function(){var a=this;S.Queue.subscribe("moat-tag",function(e){a.initMoatTracking(e.videoElement,e.duration)}),S.Queue.subscribe("vpaid-events",function(e){var t=e.type!==S.VPAIDevents.AdError?S.ad.getAdVolume():-1,i={type:e.type,adVolume:t};if(e.type===S.VPAIDevents.AdDurationChange&&(i.duration=e.args[0],i.confirmed=!0),"moat_DURATION_DEBUG"===e.type){if(!e.args||e.length<2)return;i[e.args[0]]=e.args[1]}if(a.moatapi&&"function"==typeof a.moatapi.dispatchEvent){if(a.eventBuffer&&0<a.eventBuffer.length)for(var n=a.eventBuffer.length-1;0<=n;n--){var r=a.eventBuffer[n];a.moatapi.dispatchEvent(r)}a.eventBuffer=!1,a.moatapi.dispatchEvent(i)}else a.eventBuffer&&a.eventBuffer.push(i)}),S.Queue.subscribe("moatapi-events",function(e){a.moatapi&&a.moatapi.adData&&a.moatapi.adData.ids&&!a.moatapi.adData.ids[e.property]?a.moatapi.adData.ids[e.property]=e.value:a.ids&&!a.ids[e.property]&&(a.ids[e.property]=e.value)}),S.Queue.subscribe("moatvideo-events",function(e){e.type&&"AdClicked"===e.type&&S.underlyingAsset&&S.underlyingAsset.onAdClickHandler&&S.underlyingAsset.onAdClickHandler()})},e.prototype.initMoatTracking=function(e,t){var i=document.createElement("script"),n=[],r={vidIntType:"2",vidIntVersion:"6.1",adData:{ids:this.ids,duration:t},dispatchEvent:function(e){this.sendEvent?(n&&(n.push(e),e=n,n=!1),this.sendEvent(e)):n&&n.push(e)},publishToWrapper:function(e){S.Queue.publish("moatvideo-events",e)}},a="_moatApi"+m.floor(1e8*m.random()),o=S.Util.getDocAndWinOfEl(e),s=(o.elDoc,o.elWin);if(!s)return!1;this.moatapi=s[a]=r,i.type="text/javascript",e&&e.insertBefore(i,e.childNodes[0]||null);var d="#"+a;i.src="https://z.moatads.com/"+this.pcode+"/moatvideo.js"+d},e},o=function(){function e(){this._width,this._height,this._viewMode,this._desiredBitrate,this._creativeData,this._environmentVars,this._slot,this._videoSlot,this._domElToTrack,this._hasIcons=!1,this._adStopped}return e.prototype={initAd:S.Util.makeSafe(function(e,t,i,n,r,a){var o,s;this._width=e,this._height=t,this._viewMode=i||"normal",this._desiredBitrate=n,this._creativeData=r,this._environmentVars=a,this._slot=a.slot,this._videoSlot=a.videoSlot,"string"==typeof this._videoSlot.nodeName&&"number"==typeof this._videoSlot.nodeType?this._domElToTrack=this._videoSlot:this._domElToTrack=this._slot,S&&S.moatTag&&S.moatTag.ids&&this._domElToTrack&&(t="number"==typeof this._domElToTrack.offsetHeight?this._domElToTrack.offsetHeight:"-",e="number"==typeof this._domElToTrack.offsetWidth?this._domElToTrack.offsetHeight:"-",S.moatTag.ids.origSize=e+"x"+t),this._domElToTrack&&this._domElToTrack.parentNode&&this._domElToTrack.parentNode.id&&"fw-pdk-plugin-video-display-base"==this._domElToTrack.parentNode.id&&(o=this._domElToTrack.offsetHeight,s=this._domElToTrack.offsetWidth,("number"==typeof o&&!isNaN(o)&&0==o||"number"==typeof s&&!isNaN(s)&&0==s)&&this._height&&this._width&&this._domElToTrack.style&&(this._domElToTrack.style.height=this._height+"px",this._domElToTrack.style.width=this._width+"px"));var d,l;S.qs.vast,S.qs.asset;S.qs.vast?(S.VastLoader=c(),(new S.VastLoader).request(S.qs.vast)):S.qs.asset?(S.VideoPlayer=U(),d=new S.VideoPlayer,S.underlyingAsset=d,l=[{fileURL:S.qs.asset,mimeType:"video/mp4",height:this._height,width:this._width,bitrate:this._desiredBitrate}],d.init(l,!1,S.qs.clickTag,!1)):S.Queue.publish("vpaid-events",{type:S.VPAIDevents.AdError,args:["AdError"]})},!0),collapseAd:S.Util.makeSafe(function(){S.underlyingAsset&&S.underlyingAsset.collapseAd()},!0),constructor:S.Util.makeSafe(constructor,!0),expandAd:S.Util.makeSafe(function(){S.underlyingAsset&&S.underlyingAsset.expandAd()},!0),getAdCompanions:S.Util.makeSafe(function(){if(S.underlyingAsset)return S.underlyingAsset.getAdCompanions()},!0),getAdDuration:S.Util.makeSafe(function(){return S.underlyingAsset?S.underlyingAsset.getAdDuration():-2},!0),getAdExpanded:S.Util.makeSafe(function(){if(S.underlyingAsset)return S.underlyingAsset.getAdExpanded()},!0),getAdHeight:S.Util.makeSafe(function(){if(S.underlyingAsset)return S.underlyingAsset.getAdHeight()},!0),getAdIcons:S.Util.makeSafe(function(){if(S.underlyingAsset)return S.underlyingAsset.getAdIcons()||S.ad._hasIcons},!0),getAdLinear:S.Util.makeSafe(function(){if(S.underlyingAsset)return S.underlyingAsset.getAdLinear()},!0),getAdRemainingTime:S.Util.makeSafe(function(){return S.underlyingAsset?S.underlyingAsset.getAdRemainingTime():-2},!0),getAdSkippableState:S.Util.makeSafe(function(){if(S.underlyingAsset)return S.underlyingAsset.getAdSkippableState()},!0),getAdVolume:S.Util.makeSafe(function(){return S.underlyingAsset?S.underlyingAsset.getAdVolume():1},!0),getAdWidth:S.Util.makeSafe(function(){if(S.underlyingAsset)return S.underlyingAsset.getAdWidth()},!0),handshakeVersion:S.Util.makeSafe(function(e){return S.version},!0),pauseAd:S.Util.makeSafe(function(){S.underlyingAsset&&S.underlyingAsset.pauseAd()},!0),resizeAd:S.Util.makeSafe(function(e,t,i){S.underlyingAsset&&S.underlyingAsset.resizeAd(e,t,i)},!0),resumeAd:S.Util.makeSafe(function(){S.underlyingAsset&&S.underlyingAsset.resumeAd()},!0),setAdVolume:S.Util.makeSafe(function(e){!1===isNaN(e)&0<=e&&e<=1&&S.underlyingAsset&&S.underlyingAsset.setAdVolume(e)},!0),skipAd:S.Util.makeSafe(function(){S.underlyingAsset&&S.underlyingAsset.skipAd()},!0),startAd:S.Util.makeSafe(function(){S.underlyingAsset&&S.underlyingAsset.startAd()},!0),stopAd:S.Util.makeSafe(function(){!0!==this._adStopped&&S.underlyingAsset&&(S.underlyingAsset.stopAd(),this._adStopped=!0)},!0),subscribe:S.Util.makeSafe(function(e,t,i){var n=S.playerProvidedEventCallbacks;n[t]?n[t].push({fn:e,listenerScope:i}):n[t]=[{fn:e,listenerScope:i}]},!0),unsubscribe:S.Util.makeSafe(function(e,t){var i=S.playerProvidedEventCallbacks[t];if(i)for(var n=i.length-1;0<=n;n--){e===i[n].fn&&i.splice(n,1)}},!0)},e},s=function(){var a={"vpaid-events":[],"moat-tag":[],"internal-events":[],"skip-button":[],"moatapi-events":[],"brandsafety::ready":[],"moatvideo-events":[],"wrapper-to-moatvideo-events":[]};return{subscribe:function(e,t){if(a[e]){var i=a[e].push(t)-1;return{remove:function(){delete a[e][i]}}}},publish:function(e,t){if(a[e])for(var i=a[e],n=i.length-1;0<=n;n--){var r=i[n];"function"==typeof r&&r.call(null,t)}}}},l=(e.prototype.init=function(){if(this.icons&&this.icons.length){for(var e=0;e<this.icons.length;e++)this.createIcon(this.icons[e]);this.iconsCreated=!0,S.ad._hasIcons=!0}},e.prototype.createIconContainer=function(e){var t=document.createElement("DIV");return t.id="icon"+e.program,t.style.width=e.width+"px",t.style.height=e.height+"px",t.style.position="absolute",t.style.left="number"==typeof e.xPosition?e.xPosition+"px":this.calculateLeft(e.xPosition,e.width),t.style.top="number"==typeof e.yPosition?e.yPosition+"px":this.calculateTop(e.yPosition,e.height),t.style.zIndex="2147483647",t},e.prototype.createIconAnchor=function(e){var t=document.createElement("A");return t.href=e,t.target="_blank",t},e.prototype.createIconLogo=function(e){var t=document.createElement("IMG");return t.src=e,t.border="0px",t.style.width="100%",t.style.height="100%",t},e.prototype.createIcon=function(e){var t,i,n;S.Util.isANumber(e.width)&&S.Util.isANumber(e.height)&&e.staticResource&&(t=this.createIconContainer(e),i=this.createIconLogo(e.staticResource),e.iconClickThroughURLTemplate?((n=this.createIconAnchor(e.iconClickThroughURLTemplate)).appendChild(i),t.appendChild(n)):t.appendChild(i),"VIDEO"===this.playerEl.nodeName?this.playerEl.parentNode&&"function"==typeof this.playerEl.parentNode.insertBefore&&this.playerEl.parentNode.insertBefore(t,this.playerEl.nextSibling):this.playerEl.appendChild(t),S.Util.addListener(t,"click",u,"iconClickListener"+this.iconNodes.length),this.iconNodes.push(t))},e.prototype.calculateLeft=function(e,t){if("string"==typeof e&&"left"===e.toLowerCase())return"0px";var i=this.playerEl.offsetWidth||this.playerEl.clientWidth||0;return Number(i)-Number(t)+"px"},e.prototype.calculateTop=function(e,t){if("string"==typeof e&&"top"===e.toLowerCase())return"0px";var i=this.playerEl.offsetHeight||this.playerEl.clientHeight||0;return Number(i)-Number(t)+"px"},e.prototype.adjustIconPostionOnResize=function(){if(null!==this.iconNodes&&0!==this.iconNodes.length)for(var e=0;e<this.iconNodes.length;e++){var t=this.iconNodes[e];"0px"!==t.style.left&&(t.style.left=this.calculateLeft(null,t.style.width.slice(0,-2))),"0px"!==t.style.top&&(t.style.top=this.calculateTop(null,t.style.height.slice(0,-2)))}},e.prototype.vpaidEventSubscription=function(e){switch(e.type){case S.VPAIDevents.AdVideoStart:this.iconsCreated||this.init();break;case S.VPAIDevents.AdSizeChange:this.iconsCreated&&this.adjustIconPostionOnResize();break;case S.VPAIDevents.AdVideoComplete:case S.VPAIDevents.AdStopped:case S.VPAIDevents.AdSkipped:case S.VPAIDevents.AdError:this.cleanUpCalled||this.cleanUp();break;default:break}},e.prototype.cleanUp=function(){this.subscription.remove();for(var e=0;e<this.iconNodes.length;e++){var t=this.iconNodes[e];S.Util.removeListener(t,"click",u,"iconClickListener"+e);var i=t.parentNode;i&&i.removeChild&&i.removeChild(t)}this.playerEl=null,this.icons=null,this.iconNodes=null,this.cleanUpCalled=!0,S.ad._icons=!1},e);function e(e,t){this.iconNodes=[],this.icons=e,this.playerEl=t,this.iconsCreated=!1,this.cleanUpCalled=!1,this.subscription=S.Queue.subscribe("vpaid-events",this.vpaidEventSubscription.bind(this))}function u(e){return e.stopPropagation(),!1}var I=function(){var g={AdSkipped:"skip",AdStarted:"creativeView",AdVideoStart:"start",AdVideoFirstQuartile:"firstQuartile",AdVideoMidpoint:"midpoint",AdVideoThirdQuartile:"thirdQuartile",AdVideoComplete:"complete",AdUserAcceptInvitation:"acceptInvitation",AdUserMinimize:"collapse",AdUserClose:"close",AdPaused:"pause",AdPlaying:"resume",AdError:"error",AdProgress:"progress"};function A(e,t){return t&&e&&e[t]?e[t]:[]}return ProgressEventDetails=function(e,t,i){this.urls=e,this.format=t,this.value=i},(I=function(e,t,i,n,r,a){this.trackingEvents=e,this.impressionURLs=t,this.scrURLS=S.Util.getScrUrls(),this.errorURLs=i,this.clicktrackingURLs=n,this.customTrackingEvents=a,this.lastVolume=!1,this.surveys=r,this.init()}).prototype.init=function(){var m=this;m.progressEvents=function(e){var t={},i=/progress-([0-9]+)/;for(var n in e)if(-1<S.Util.indexOf(n,"progress")){var r=n.match(i);if(!r||r.length<2)continue;var a=e[n],o=r[1];-1<S.Util.indexOf(n,"%")?t[n]=new ProgressEventDetails(a,"percentage",parseFloat(o/100)):t[n]=new ProgressEventDetails(a,"number",parseFloat(o))}return t}(this.trackingEvents),S.Queue.subscribe("internal-events",function(e){m.lastVolume=e.volume}),S.Queue.subscribe("vpaid-events",function(e){var t,i=!1;switch(e.type){case S.VPAIDevents.AdImpression:m.handleSurveys(),p=m.impressionURLs,i=!0;break;case S.VPAIDevents.AdVolumeChange:var n,r=S.underlyingAsset&&S.underlyingAsset.getAdVolume();"number"==typeof m.lastVolume&&"number"==typeof r&&(0===r&&0<m.lastVolume?n="mute":0<r&&0===m.lastVolume&&(n="unmute")),m.lastVolume=r,n&&(p=m.trackingEvents[n]);break;case S.VPAIDevents.AdClickThru:p=m.clicktrackingURLs;break;case S.VPAIDevents.AdError:p=m.errorURLs;break;case S.VPAIDevents.AdProgress:var a=[];for(var o in m.progressEvents){var s,d,l=m.progressEvents[o],u=e.time;"percentage"==l.format?(s=-2!=S.underlyingAsset.getAdDuration(),d=l.value*S.underlyingAsset.getAdDuration(),s&&d<u&&(a=a.concat(l.urls),delete m.progressEvents[o])):u>l.value&&(a=a.concat(l.urls),delete m.progressEvents[o])}p=a;break;default:var c=g[e.type],p=A(m.trackingEvents,c).concat(A(m.customTrackingEvents,c));break}if(p)for(var h=p.length-1;0<=h;h--)if("string"==typeof(t=p[h]))try{(new Image).src=t}catch(e){}if(i)for(var v=m.scrURLS,f=v.length-1;0<=f;f--)S.Util.addScriptToDOM(v[f],S.ad._domElToTrack)})},I.prototype.handleSurveys=function(){if(this.surveys&&S.ad._domElToTrack)for(var e,t,i,n,r,a,o,s,d,l=S.ad._domElToTrack,u=this.surveys,c=!1,p=0;p<u.length;p++)if(e=u[p],d=s=o=a=void 0,"js"==("js"===((r=e).type?"javascript"===(a=r.type.split("/"))[a.length-1]?"js":"pixel":(d=(s=(o=r.url.match(/([^/&?#]+)(?:$|#|\?)/i))&&2===o.length&&o[1])&&s.split("."))&&d[d.length-1])?"js":"pixel")){if(c||(i=(t=S.Util.getDocAndWinOfEl(l)).elDoc,n=t.elWin,c=!0),!n)continue;var h=i.createElement("script");h.src=e.url,h.type="text/javascript";var v=S.Util.getParentNode(l)||l;v.insertBefore(h,v.childNodes[0]||null)}else(new Image).src=e.url},I},c=function(){function e(){}function E(e){var t=e.extensions,o={};for(var i in t)!function e(t){if(void 0!==t.children&&0!==t.children.length)for(var i,n,r=t.children,a=0;a<r.length;a++)"Tracking"===r[a].name&&(i=r[a].attributes.event,n=r[a].value,o[i]=[n]),e(r[a])}(t[i]);return o}return e.prototype.request=function(e){var t=this,i=!1;e&&e.match("ad.doubleclick.net")&&(i=!0),DMVAST.client.get(e,{withCredentials:i},function(e){e?t.extractStuff(e):S.Queue.publish("vpaid-events",{type:S.VPAIDevents.AdError,args:["no VAST tag response"]})})},e.prototype.extractStuff=function(e){var t=["progressive"];if(e&&e.ads&&0!==e.ads.length){var i={linearCreatives:[],companions:[]},n=e.ads[0];n.id&&"null"!==n.id&&S.Queue.publish("moatapi-events",{property:"zMoatAdId",value:n.id});var r=n&&n.creatives&&n.creatives[0]&&n.creatives[0].videoClickThroughURLTemplate;r&&S.Queue.publish("moatapi-events",{property:"zMoatClickThrough",value:r});for(var a=n.creatives,o=0;o<a.length;o++){var s=a[o];switch(s.type){case"linear":for(var d={duration:s.duration,adParameters:s.adParameters,trackingEvents:s.trackingEvents,clickthroughURL:s.videoClickThroughURLTemplate,clicktrackingURLs:s.videoClickTrackingURLTemplates,vpaid:[],videos:[],skipoffset:s.skipDelay,icons:s.icons},l=s.mediaFiles,u=0;u<l.length;u++){var c=l[u],p=c.mimeType.toLowerCase(),h=c.deliveryType.toLowerCase();"VPAID"!==c.apiFramework||"application/javascript"!==p&&"application/x-javascript"!==p||!S.Util.arrayContains(t,h)||d.vpaid.push(c),S.Util.arrayContains(t,h)&&d.videos.push(c)}i.linearCreatives.push(d),n.creativeId||function(e,t){var i;for(var n in t)"id"===n.toLowerCase()?e.creativeId=t[n]:"adid"===n.toLowerCase()&&(i=t[n]);e.creativeId?i&&(e.creativeAdId=i):i&&(e.creativeId=i),e.creativeId&&S.Queue.publish("moatapi-events",{property:"zMoatCreativeId",value:e.creativeId}),e.creativeAdId&&S.Queue.publish("moatapi-events",{property:"zMoatCreativeAdId",value:e.creativeAdId})}(n,s.attributes);break;case"companion":for(var v=0;v<s.variations.length;v++)i.companions.push(s.variations[v])}}var f,m,g=i.linearCreatives.length;if(1===g)f=i.linearCreatives[0];else for(o=0;o<g;o++){var A=i.linearCreatives[o];if(0<A.videos.length||0<A.vpaid.length){f=A;break}}if(f||S.Queue.publish("vpaid-events",{type:S.VPAIDevents.AdError,args:["No suitable assets found"]}),f.customTrackingEvents=E(n),S.TrackerManager=I(),new S.TrackerManager(f.trackingEvents,n.impressionURLTemplates,n.errorURLTemplates,f.clicktrackingURLs,n.surveys,f.customTrackingEvents),0<i.companions.length){S.CompanionLoader=T();for(var y=new S.CompanionLoader,_=0;_<i.companions.length;_++){var k,C,b=i.companions[_];b.htmlResource?(k="HTMLResource",C=b.htmlResource):b.iframeResource?(k="IFrameResource",C=b.iframeResource):b.staticResource&&(k="StaticResource",C=b.staticResource),y.loadCompanion(k,b.type,b.width,b.height,C,!1,b.companionClickThroughURLTemplate,b.trackingEvents.creativeView)}}if(0<f.vpaid.length)return S.VpaidPlayer=V(),void(m=new S.VpaidPlayer).init(f.vpaid[0],f.adParameters,f.duration,i.companions,f.icons,f.clickthroughURL);0<f.videos.length?(S.Queue.publish("vpaid-events",{type:"moat_DURATION_DEBUG",args:["mediafile","video"]}),S.Queue.publish("vpaid-events",{type:"moat_DURATION_DEBUG",args:["vast-duration",f.duration]}),S.VideoPlayer=U(),m=new S.VideoPlayer,(S.underlyingAsset=m).init(f.videos,f.duration,f.clickthroughURL,i.companions,f.skipoffset,f.icons)):S.Queue.publish("vpaid-events",{type:S.VPAIDevents.AdError,args:["No suitable assets found"]})}},e},U=function(){function e(){this._videoEl,this._adIsStarted,this._firstQuartileTime,this._firstQuartileReached,this._midpointTime,this._midpointReached,this._thirdQuartileTime,this._thirdQuartileReached,this._videoIsCompleted,this._lastViewMode,this._originalSlotCursorStyle,this._originalVideoSlotCursorStyle,this._pauseAdOnClickThru=!0,this._clickthroughURL,this._lastClickTime,this._skipoffset,this._cleanupCalled,this._durationConfirmed=!1,this._adLinear=!0,this._adWidth=S.ad._width,this._adHeight=S.ad._height,this._adExpanded=!1,this._adSkippableState=!1,this._adRemainingTime=-2,this._adDuration=-2,this._adVolume=1,this._adCompanions="",this._adIcons=!1,this._skipButtonModule=t(),this._skipButtonManager,this._icons,this._iconManager}return e.prototype.init=function(e,t,i,n,r,a){this._videoEl=S.ad._videoSlot,this._adDuration=this._adRemainingTime=t,this._mediaFile=this.pickMediaFile(e);this._skipoffset=function(){var e=r;if(S.Util.isANumber(e))return e;var t=parseInt(S.qs.skip,10);if(S.Util.isANumber(t))return t;var i=parseInt(S.qs.zMoatSkip,10);return S.Util.isANumber(i)?i:null}();var o=S&&S.ad&&S.ad._slot,s=S&&S.ad&&S.ad._videoSlot;o&&o.style&&(this._originalSlotCursorStyle=o.style.cursor,o.style.cursor="pointer"),s&&s.style&&(this._originalVideoSlotCursorStyle=s.style.cursor,s.style.cursor="pointer"),void 0!==this._videoEl.volume&&"number"==typeof this._videoEl.volume&&(this._adVolume=this._videoEl.volume),S.Queue.publish("internal-events",{volume:this._adVolume}),this._clickthroughURL=i,this._lastViewMode=S.ad._viewMode,this._adCompanions=S.Util.createXMLcompanionNode(n),this._icons=a,this.onAdClickHandler=this.onAdClick.bind(this),this.onErrorHandler=this.videoErrorHandlerFn,this.createListeners(),"1"===S.qs.noctp&&(this._pauseAdOnClickThru=!1),S.Queue.publish("vpaid-events",{type:S.VPAIDevents.AdLoaded}),this._adDuration&&(this.determineQuartiles(),S.Queue.publish("moat-tag",{videoElement:S.ad._domElToTrack,duration:this._adDuration}))},e.prototype.resizeAd=function(e,t,i,n){"string"==typeof i&&(i=i.toLowerCase());var r=i&&"fullscreen"===i,a="number"==typeof e&&"number"==typeof t&&!isNaN(e)&&!isNaN(t),o=!r&&a;!r&&!a||o&&!this._videoEl||(o&&(this._adHeight=t,this._adWidth=e,this._videoEl.width=e,this._videoEl.height=t),n&&S.ad._slot&&(S.ad._slot.style.width=e+"px",S.ad._slot.style.height=t+"px"),S.Queue.publish("vpaid-events",{type:S.VPAIDevents.AdSizeChange}))},e.prototype.playVideoEl=function(e){var t=this._videoEl.play();return S.Util.isPromise(t)?t.then(e).catch(this.onErrorHandler):(e(),null)},e.prototype.playVideoElandFireStartEvents=function(){var e=this._videoEl,t=!1,i=!1;function n(){this._adIsStarted||(this._adIsStarted=!0,this._adTimeFrequency=0,this.timer(),S.Queue.publish("vpaid-events",{type:S.VPAIDevents.AdStarted}),S.Queue.publish("vpaid-events",{type:S.VPAIDevents.AdImpression}),S.Queue.publish("vpaid-events",{type:S.VPAIDevents.AdVideoStart}))}function r(){i&&t&&(S.Util.removeListener(e,"playing",a,"videoPlayingHandlerFn"),n())}function a(){t=!0,r()}n=n.bind(this),S.Util.addListener(e,"playing",a,"videoPlayingHandlerFn"),this.playVideoEl(function(){i=!0,r()})},e.prototype.startAd=function(){var e;this._adIsStarted||(this.setVideoElSrc(this._mediaFile),S.ad&&S.ad._slot&&((e="function"==typeof window.getComputedStyle&&window.getComputedStyle(S.ad._slot)||S.ad._slot.style||S.ad._slot.currentStyle)&&S.ad._width&&S.ad._height&&("0px"==e.width&&0<S.ad._width||"0px"==e.height&&0<S.ad._height)&&this.resizeAd(S.ad._width,S.ad._height,S.ad._viewMode||"normal",!0)),S.Util.isANumber(this._skipoffset)?this._skipButtonManager=new this._skipButtonModule(S.ad._slot):this._skipButtonManager=null,this._videoEl.load(),this.playVideoElandFireStartEvents(),this._icons&&this._icons.length&&(this._iconManager=new l(this._icons,S.ad._domElToTrack),this._adIcons=!0))},e.prototype.stopAd=function(){this.cleanUp(),S.Queue.publish("vpaid-events",{type:S.VPAIDevents.AdStopped})},e.prototype.pauseAd=function(){this._videoEl.paused||(this._videoEl.pause(),S.Queue.publish("vpaid-events",{type:S.VPAIDevents.AdPaused}))},e.prototype.resumeAd=function(){this.playVideoEl(function(){S.Queue.publish("vpaid-events",{type:S.VPAIDevents.AdPlaying})})},e.prototype.skipAd=function(){this.cleanUp(),S.Queue.publish("vpaid-events",{type:S.VPAIDevents.AdSkipped});S.Util.setSafeTimeout(function(){S.Queue.publish("vpaid-events",{type:S.VPAIDevents.AdStopped})},400)},e.prototype.getAdLinear=function(){return this._adLinear},e.prototype.getAdCompanions=function(){return this._adCompanions},e.prototype.getAdExpanded=function(){return this._adExpanded},e.prototype.getAdHeight=function(){return this._adHeight},e.prototype.getAdWidth=function(){return this._adWidth},e.prototype.getAdVolume=function(){var e=1,t=this._videoEl.volume,i=this._adVolume;return this._videoEl.muted?e=0:"number"!=typeof t||isNaN(t)?"number"!=typeof i||isNaN(i)||(e=i):e=t,e},e.prototype.setAdVolume=function(e){this._adVolume=e,"number"==typeof this._videoEl.volume&&(this._videoEl.volume=e),S.Queue.publish("vpaid-events",{type:S.VPAIDevents.AdVolumeChange})},e.prototype.getAdRemainingTime=function(){return this._adDuration-this._videoEl.currentTime},e.prototype.getAdDuration=function(){return this._adDuration},e.prototype.getAdIcons=function(){return this._adIcons},e.prototype.getAdSkippableState=function(){return this._adSkippableState},e.prototype.setVideoElSrc=function(e){e&&"string"==typeof e.fileURL&&e.fileURL.length?this._videoEl.src=e.fileURL:S.Queue.publish("vpaid-events",{type:S.VPAIDevents.AdError,args:["invalid mediaFile or mediaFile fileURL"]})},e.prototype.pickMediaFile=function(e){for(var n=this._adWidth*this._adHeight,t=function(e){var t={};t.bitrateRange=e.bitrate<5e3?0:1,t.canPlayType="probably"===this._videoEl.canPlayType(e.mimeType)?0:1;var i=e.width*e.height;return t.sizeDiff=m.abs(n-i),t.bitrate=e.bitrate,t.mediaFile=e,t}.bind(this),i=[],r=0;r<e.length;r++){var a,o=e[r];""!==this._videoEl.canPlayType(o.mimeType)&&(a=t(o),i.push(a))}return 0===i.length&&S.Queue.publish("vpaid-events",{type:S.VPAIDevents.AdError,args:["AdError"]}),i.sort(function(e,t){var i=e.bitrateRange-t.bitrateRange;if(0!=i)return i;var n=e.canPlayType-t.canPlayType;if(0!=n)return n;var r=e.sizeDiff-t.sizeDiff;return 0!=r?r:t.bitrate-e.bitrate}),i[0].mediaFile},e.prototype.onAdClick=function(){var e=(new d).getTime();if(!(void 0===this._lastClickTime)){if(e-this._lastClickTime<100)return}this._lastClickTime=e,void 0!==this._adIsStarted?this._videoEl.paused?this.resumeAd():(S.Queue.publish("vpaid-events",{type:S.VPAIDevents.AdClickThru,args:[this._clickthroughURL,null,!0]}),this._pauseAdOnClickThru&&this.pauseAd()):this.startAd()},e.prototype.videoErrorHandlerFn=function(e){var t,i,n=function(e){var t,i="string"==typeof(t=e).message?t.message:t.target&&t.target.error&&"string"==typeof t.target.error.message?t.target.error.message:"";if(""!==i){var n=["request is not allowed by the user agent or the platform in the current context","can only be initiated by a user gesture"];for(var r in n){var a=n[r];if(S.Util.arrayContains(i,a))return 1}}}(e)?"Autoplay attempted and is not allowed":"AdError";try{t=S.qs.level1+"%3A"+S.qs.level2+"%3A"+S.qs.level3+"%3A"+S.qs.level4}catch(e){t="data%3Adata%3Adata%3Adata"}try{i=S.qs.vast}catch(e){i="-"}i=i&&i.replace(/gdpr_consent=[^&]*&?/i,"");var r="//px.moatads.com/pixel.gif?e=24&d="+t+"&i="+encodeURIComponent("SPECTRUMREACHVPAID1")+"&ac=1&k="+encodeURIComponent(n)+"&ar="+encodeURIComponent("97b82f9bf7-clean")+"&iw="+encodeURIComponent("eefd067")+"&j="+encodeURIComponent(document.referrer)+"&zMoatVast="+encodeURIComponent(i)+"&cs="+(new d).getTime();(new Image).src=r,S.Queue.publish("vpaid-events",{type:S.VPAIDevents.AdError,args:[n]})},e.prototype.createListeners=function(){S.Util.addListener(S.ad._slot,"click",this.onAdClickHandler,"slotClickHandlerFn"),S.Util.addListener(S.ad._videoSlot,"click",this.onAdClickHandler,"videoSlotClickHandlerFn"),S.Util.addListener(this._videoEl,"error",this.onErrorHandler,"videoErrorHandlerFn")},e.prototype.determineQuartiles=function(){var e=this._adDuration/4;this._firstQuartileTime=0+e,this._midpointTime=this._firstQuartileTime+e,this._thirdQuartileTime=this._midpointTime+e},e.prototype.onConfirmDuration=function(e){if(!this._adDuration&&0!==this._adDuration){if(!S.ad._domElToTrack)return S.Queue.publish("vpaid-events",{type:S.VPAIDevents.AdError,args:["AdError"]}),!1;S.Queue.publish("moat-tag",{videoElement:S.ad._domElToTrack,duration:e})}this._adDuration=e,this.determineQuartiles(),this._durationConfirmed=!0,S.Queue.publish("vpaid-events",{type:S.VPAIDevents.AdDurationChange,args:[e]})},e.prototype.confirmDuration=function(){var e;this._durationConfirmed||"number"==typeof(e=this._videoEl&&this._videoEl.duration)&&!isNaN(e)&&0<e&&this.onConfirmDuration(m.round(e))},e.prototype.timer=function(){var e,t=(e=this,function(){e.confirmDuration(),e._adDuration&&e.progressWatcher()});S.Util.setSafeLoop(t,[],500)},e.prototype.progressWatcher=function(){this._skipButtonManager&&!this._adSkippableState&&this._videoEl.currentTime>this._skipoffset&&(this._adSkippableState=!0,S.Queue.publish("vpaid-events",{type:S.VPAIDevents.AdSkippableStateChange})),S.Queue.publish("skip-button",{timeLeft:m.max(m.round(this._skipoffset-this._videoEl.currentTime),0)}),this._adIsStarted&&!this._firstQuartileReached&&this._videoEl.currentTime>this._firstQuartileTime?(this._firstQuartileReached=!0,S.Queue.publish("vpaid-events",{type:S.VPAIDevents.AdVideoFirstQuartile})):this._adIsStarted&&this._firstQuartileReached&&!this._midpointReached&&this._videoEl.currentTime>this._midpointTime?(this._midpointReached=!0,S.Queue.publish("vpaid-events",{type:S.VPAIDevents.AdVideoMidpoint})):this._adIsStarted&&this._firstQuartileReached&&this._midpointReached&&!this._thirdQuartileReached&&this._videoEl.currentTime>this._thirdQuartileTime?(this._thirdQuartileReached=!0,S.Queue.publish("vpaid-events",{type:S.VPAIDevents.AdVideoThirdQuartile})):this._adIsStarted&&this._firstQuartileReached&&this._midpointReached&&this._thirdQuartileReached&&!this._videoIsCompleted&&(this._videoEl.currentTime>=this._adDuration||this._videoEl.ended)&&(this.cleanUp(),this._videoIsCompleted=!0,S.Queue.publish("vpaid-events",{type:S.VPAIDevents.AdVideoComplete}),S.Util.setSafeTimeout(function(){S.Queue.publish("vpaid-events",{type:S.VPAIDevents.AdStopped})},400)),this._adIsStarted&&!this._videoIsCompleted&&S.Queue.publish("vpaid-events",{type:S.VPAIDevents.AdProgress,time:this._videoEl.currentTime})},e.prototype.cleanUp=function(){this._cleanupCalled||(this._cleanupCalled=!0,S.Util.removeListener(this._videoEl,"playing",function(){},"videoPlayingHandlerFn"),S.Util.removeListener(S.ad._slot,"click",this.onAdClickHandler,"slotClickHandlerFn"),S.Util.removeListener(S.ad._videoSlot,"click",this.onAdClickHandler,"videoSlotClickHandlerFn"),S.Util.removeListener(this._videoEl,"error",this.onErrorHandler,"videoErrorHandlerFn"),S.ad._slot.style&&(S.ad._slot.style.cursor=this._originalSlotCursorStyle),S.ad._videoSlot.style&&(S.ad._videoSlot.style.cursor=this._originalVideoSlotCursorStyle),this._skipButtonManager&&this._skipButtonManager.cleanUp(),this._adIcons=!1)},e},V=function(){return(V=function(){this._iframe,this._adCompanions,this._lastAdVolume,this._adParameters,this._icons,this._iconManager,this._clickthroughURL}).prototype.init=function(e,t,i,n,r,a){var o,s,d,l=m.random()+"";window["moatstartvpaid"+l]=this.startVPAID.bind(this),window["moatstartvpaiderr"+l]=this.handleError.bind(this),e&&e.fileURL&&e.fileURL.match(/^https?:\/\/(s0\.2mdn\.net|imasdk\.googleapis\.com)/)?((o=document.createElement("script")).type="text/javascript",o.onload=function(){window["moatstartvpaid"+l]()},o.onerror=function(){window["moatstartvpaiderr"+l]()},o.src=e.fileURL,S.Util.addTagSafely(o,document.body)):(s=document.createElement("iframe"),(this._iframe=s).style.display="none",document.body.appendChild(s),d='<html><head><body><script>function startVPAID() {window.parent["moatstartvpaid'+l+'"]();};function errVPAID() {window.parent["moatstartvpaiderr'+l+'"]();};<\/script><script onerror="errVPAID();" onload="startVPAID();" src="'+e.fileURL+'"><\/script></body></head></html>',s.contentWindow.moatsrc=d,s.src="javascript:window.moatsrc"),this._adCompanions=n,this._adParameters=t,this._icons=r,this._clickthroughURL=a,S.Queue.publish("moat-tag",{videoElement:S.ad._domElToTrack,duration:i})},V.prototype.handleError=function(){S.Queue.publish("vpaid-events",{type:S.VPAIDevents.AdError,args:["no VPAID response"]})},V.prototype.wrapGetAdCompanions=function(){var e=this,t=this._vpaid.getAdCompanions;this._vpaid.getAdCompanions=function(){return 0<e._adCompanions.length?S.Util.createXMLcompanionNode(e._adCompanions):t?t.call(e._vpaid):""}},V.prototype.createCallbacks=function(){var e={},t=this;for(var i in S.VPAIDevents){var n=function(){var e=i;return function(){"AdClickThru"===e&&arguments&&!arguments[0]&&(arguments[0]=t._clickthroughURL),S.Queue.publish("vpaid-events",{type:e,args:arguments})}}();e[i]=n}return e},V.prototype.startVPAID=function(){var r=this,a=!1,o=0,s=r._iframe?r._iframe.contentWindow:window;S.Util.setSafeLoop(function(){if(20<++o||a)return r.handleError(),!1;var e=s.getVPAIDAd&&"function"==typeof s.getVPAIDAd&&s.getVPAIDAd();if(e){r._vpaid=e,a=!0;e.handshakeVersion(S.version);var t=r.createCallbacks();for(var i in t)e.subscribe(t[i],i);r.wrapGetAdCompanions(),S.underlyingAsset=e;var n={AdParameters:r._adParameters};return e.initAd(S.ad._width,S.ad._height,S.ad._viewMode,S.ad._desiredBitrate,n,S.ad._environmentVars),e.getAdIcons&&e.getAdIcons()||!r._icons||!r._icons.length||(this._iconManager=new l(r._icons,S.ad._domElToTrack)),function(e){var t;try{t=e.getAdVolume()}catch(e){t=-1}S.Queue.publish("internal-events",{volume:t})}(e),!1}},[],100)},V}}(Date,Math)}catch(e){try{var t=e.name+" in global t/c: "+e.message+", stack="+e.stack,i="//px.moatads.com/pixel.gif?e=24&d=data%3Adata%3Adata%3Adata&i="+encodeURIComponent("SPECTRUMREACHVPAID1")+"&ac=1&k="+encodeURIComponent(t)+"&ar="+encodeURIComponent("97b82f9bf7-clean")+"&iw="+encodeURIComponent("eefd067")+"&j="+encodeURIComponent(document.referrer)+"&cs="+(new Date).getTime();(new Image).src=i}catch(e){}}}();


/**
* Copyright (c) 2013 Olivier Poitrey <rs@dailymotion.com>
*
* Permission is hereby granted, free of charge, to any person obtaining a copy
* of this software and associated documentation files (the "Software"), to deal
* in the Software without restriction, including without limitation the rights
* to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
* copies of the Software, and to permit persons to whom the Software is
* furnished to do so, subject to the following conditions:
*
* The above copyright notice and this permission notice shall be included in all
* copies or substantial portions of the Software.
*
* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
* IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
* FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
* AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
* LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
* OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
* SOFTWARE.
*/
 
!function(){try{e=function(){return function r(s,o,a){function l(i,e){if(!o[i]){if(!s[i]){var t="function"==typeof require&&require;if(!e&&t)return t(i,!0);if(h)return h(i,!0);throw new Error("Cannot find module '"+i+"'")}var n=o[i]={exports:{}};s[i][0].call(n.exports,function(e){var t=s[i][1][e];return l(t||e)},n,n.exports,r,s,o,a)}return o[i].exports}for(var h="function"==typeof require&&require,e=0;e<a.length;e++)l(a[e]);return l}({1:[function(e,t,i){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function a(e){return"function"==typeof e}function l(e){return"object"==typeof e&&null!==e}function h(e){return void 0===e}((t.exports=n).EventEmitter=n).prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,i,n,r,s,o;if(this._events||(this._events={}),"error"===e&&(!this._events.error||l(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;throw TypeError('Uncaught, unspecified "error" event.')}if(h(i=this._events[e]))return!1;if(a(i))switch(arguments.length){case 1:i.call(this);break;case 2:i.call(this,arguments[1]);break;case 3:i.call(this,arguments[1],arguments[2]);break;default:for(n=arguments.length,r=new Array(n-1),s=1;s<n;s++)r[s-1]=arguments[s];i.apply(this,r)}else if(l(i)){for(n=arguments.length,r=new Array(n-1),s=1;s<n;s++)r[s-1]=arguments[s];for(n=(o=i.slice()).length,s=0;s<n;s++)o[s].apply(this,r)}return!0},n.prototype.on=n.prototype.addListener=function(e,t){var i;if(!a(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,a(t.listener)?t.listener:t),this._events[e]?l(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,l(this._events[e])&&!this._events[e].warned&&(i=h(this._maxListeners)?n.defaultMaxListeners:this._maxListeners)&&0<i&&this._events[e].length>i&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},n.prototype.once=function(e,t){if(!a(t))throw TypeError("listener must be a function");var i=!1;function n(){this.removeListener(e,n),i||(i=!0,t.apply(this,arguments))}return n.listener=t,this.on(e,n),this},n.prototype.removeListener=function(e,t){var i,n,r,s;if(!a(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(r=(i=this._events[e]).length,n=-1,i===t||a(i.listener)&&i.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(l(i)){for(s=r;0<s--;)if(i[s]===t||i[s].listener&&i[s].listener===t){n=s;break}if(n<0)return this;1===i.length?(i.length=0,delete this._events[e]):i.splice(n,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,i;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(a(i=this._events[e]))this.removeListener(e,i);else for(;i.length;)this.removeListener(e,i[i.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){var t=this._events&&this._events[e]?a(this._events[e])?[this._events[e]]:this._events[e].slice():[];return t},n.listenerCount=function(e,t){var i=e._events&&e._events[t]?a(e._events[t])?1:e._events[t].length:0;return i}},{}],2:[function(e,t,i){var n=function(){this.id=null,this.errorURLTemplates=[],this.impressionURLTemplates=[],this.creatives=[],this.extensions=[],this.surveys=[]};t.exports=n},{}],3:[function(e,t,o){var a,i,n,r;function s(){}a=e("./parser"),i=e("./util"),s.cappingFreeLunch=0,s.cappingMinimumTimeInterval=0,s.options={withCredentials:!1,timeout:0},s.get=function(e,t,i){var n,r=+new Date,s=o.extend=function(e,t){var i,n;for(i in t)n=t[i],e[i]=n;return e};if(i||("function"==typeof t&&(i=t),n={}),n=s(this.options,t),this.totalCallsTimeout<r?(this.totalCalls=1,this.totalCallsTimeout=36e5+r):this.totalCalls++,this.cappingFreeLunch>=this.totalCalls)i(null);else{if(!(r-this.lastSuccessfullAd<this.cappingMinimumTimeInterval))return a.parse(e,n,function(e){return i(e)});i(null)}},n=i.storage,r=Object.defineProperty,["lastSuccessfullAd","totalCalls","totalCallsTimeout"].forEach(function(t){r(s,t,{get:function(){return n.getItem(t)},set:function(e){return n.setItem(t,e)},configurable:!1,enumerable:!0})}),null==s.totalCalls&&(s.totalCalls=0),null==s.totalCallsTimeout&&(s.totalCallsTimeout=0),t.exports=s},{"./parser":12,"./util":19}],4:[function(e,t,i){var n=function(){this.id=null,this.width=0,this.height=0,this.type=null,this.staticResource=null,this.htmlResource=null,this.iframeResource=null,this.companionClickThroughURLTemplate=null,this.trackingEvents={}};t.exports=n},{}],5:[function(e,t,i){function n(e,t){for(var i in t)a.call(t,i)&&(e[i]=t[i]);function n(){this.constructor=e}return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e}var r,s,o,a={}.hasOwnProperty;function l(){l.__super__.constructor.apply(this,arguments),this.type="linear",this.duration=0,this.skipDelay=null,this.mediaFiles=[],this.videoClickThroughURLTemplate=null,this.videoClickTrackingURLTemplates=[],this.videoCustomClickURLTemplates=[],this.adParameters=null,this.icons=[]}function h(){h.__super__.constructor.apply(this,arguments),this.type="nonlinear",this.variations=[],this.videoClickTrackingURLTemplates=[]}function u(){this.type="companion",this.variations=[],this.videoClickTrackingURLTemplates=[]}n(l,r=function(){this.trackingEvents={}}),s=l,n(h,r),o=h,n(u,r),t.exports={VASTCreativeLinear:s,VASTCreativeNonLinear:o,VASTCreativeCompanion:u}},{}],6:[function(e,t,i){var n=function(){this.attributes={},this.children=[]};t.exports=n},{}],7:[function(e,t,i){var n=function(e,t){this.name=e,this.value=t,this.attributes={},this.children=[]};t.exports=n},{}],8:[function(e,t,i){var n=function(){this.program=null,this.height=0,this.width=0,this.xPosition=0,this.yPosition=0,this.apiFramework=null,this.offset=null,this.duration=0,this.type=null,this.staticResource=null,this.htmlResource=null,this.iframeResource=null,this.iconClickThroughURLTemplate=null,this.iconClickTrackingURLTemplates=[],this.iconViewTrackingURLTemplate=null};t.exports=n},{}],9:[function(e,t,i){t.exports={client:e("./client"),tracker:e("./tracker"),parser:e("./parser"),util:e("./util")}},{"./client":3,"./parser":12,"./tracker":15,"./util":19}],10:[function(e,t,i){var n=function(){this.id=null,this.fileURL=null,this.deliveryType="progressive",this.mimeType=null,this.codec=null,this.bitrate=0,this.minBitrate=0,this.maxBitrate=0,this.width=0,this.height=0,this.apiFramework=null,this.scalable=null,this.maintainAspectRatio=null};t.exports=n},{}],11:[function(e,t,i){var n=function(){this.id=null,this.width=0,this.height=0,this.minSuggestedDuration="00:00:00",this.apiFramework="static",this.type=null,this.staticResource=null,this.htmlResource=null,this.iframeResource=null,this.nonlinearClickThroughURLTemplate=null};t.exports=n},{}],12:[function(e,t,i){var n,r,v,a,l,E,_,oe,I,ae,le,B,m,T,s,o,g=[].indexOf||function(e){for(var t=0,i=this.length;t<i;t++)if(t in this&&this[t]===e)return t;return-1};function h(){}r=e("./urlhandler"),m=e("./response"),v=e("./ad"),a=e("./extension"),l=e("./extensionchild"),s=e("./util"),oe=e("./creative").VASTCreativeLinear,_=e("./creative").VASTCreativeCompanion,I=e("./creative").VASTCreativeNonLinear,le=e("./mediafile"),ae=e("./icon"),E=e("./companionad"),B=e("./nonlinear"),T=e("./survey"),n=e("events").EventEmitter,o=[],h.addURLTemplateFilter=function(e){"function"==typeof e&&o.push(e)},h.removeURLTemplateFilter=function(){return o.pop()},h.countURLTemplateFilters=function(){return o.length},h.clearUrlTemplateFilters=function(){return o=[]},h.parse=function(e,t,i){return i||("function"==typeof t&&(i=t),t={}),this._parse(e,null,t,function(e,t){return i(t)})},h.vent=new n,h.track=function(e,t){return this.vent.emit("VAST-error",t),s.track(e,t)},h.on=function(e,t){return this.vent.on(e,t)},h.once=function(e,t){return this.vent.once(e,t)},h._parse=function(c,p,d,f){var e,t,i,L;for(f||("function"==typeof d&&(f=d),d={}),t=0,i=o.length;t<i;t++)e=o[t],c=e(c);return null==p&&(p=[]),p.push(c),r.get(c,d,(L=this,function(e,t){var r,y,i,n,k,s,o,a,l,h,u;if(null!=e)return f(e);if(k=new m,null==(null!=t?t.documentElement:void 0)||"VAST"!==t.documentElement.nodeName)return f();for(s=0,a=(h=t.documentElement.childNodes).length;s<a;s++)"Error"===(n=h[s]).nodeName&&k.errorURLTemplates.push(L.parseNodeText(n));for(o=0,l=(u=t.documentElement.childNodes).length;o<l;o++)"Ad"===(n=u[o]).nodeName&&(null!=(r=L.parseAdElement(n))?k.ads.push(r):L.track(k.errorURLTemplates,{ERRORCODE:101}));for(y=function(e){var t,i,n;if(null==e&&(e=!1),k){for(t=0,i=(n=k.ads).length;t<i;t++)if(null!=(r=n[t]).nextWrapperURL)return;return 0===k.ads.length&&(e||L.track(k.errorURLTemplates,{ERRORCODE:303}),k=null),f(null,k)}},i=k.ads.length;i--;)null!=(r=k.ads[i]).nextWrapperURL&&function(T){var e,t,i;10<=p.length||(i=T.nextWrapperURL,0<=g.call(p,i))?(L.track(T.errorURLTemplates,{ERRORCODE:302}),k.ads.splice(k.ads.indexOf(T),1),y()):(0===T.nextWrapperURL.indexOf("//")?(t=location.protocol,T.nextWrapperURL=""+t+T.nextWrapperURL):-1===T.nextWrapperURL.indexOf("://")&&(e=c.slice(0,c.lastIndexOf("/")),T.nextWrapperURL=e+"/"+T.nextWrapperURL),L._parse(T.nextWrapperURL,p,d,function(e,t){var i,n,r,s,o,a,l,h,u,c,p,d,f,m,g,v=!1;if(null!=e)L.track(T.errorURLTemplates,{ERRORCODE:301}),k.ads.splice(k.ads.indexOf(T),1),v=!0;else if(null==t)L.track(T.errorURLTemplates,{ERRORCODE:303}),k.ads.splice(k.ads.indexOf(T),1),v=!0;else for(k.errorURLTemplates=k.errorURLTemplates.concat(t.errorURLTemplates),r=k.ads.indexOf(T),k.ads.splice(r,1),l=0,h=(f=t.ads).length;l<h;l++){for((o=f[l]).errorURLTemplates=T.errorURLTemplates.concat(o.errorURLTemplates),o.impressionURLTemplates=T.impressionURLTemplates.concat(o.impressionURLTemplates),s=!0,p=0,u=(m=o.creatives).length;p<u;p++){if(i=m[p],null!=T.trackingEvents&&("linear"===i.type||"nonlinear"===i.type))for(d=0,c=(g=Object.keys(T.trackingEvents)).length;d<c;d++)n=g[d],(a=i.trackingEvents)[n]||(a[n]=[]),i.trackingEvents[n]=i.trackingEvents[n].concat(T.trackingEvents[n]);null!=T.videoClickTrackingURLTemplates&&("linear"!==i.type&&"nonlinear"!==i.type||(i.videoClickTrackingURLTemplates=i.videoClickTrackingURLTemplates.concat(T.videoClickTrackingURLTemplates))),T.tempCompanionAd&&"companion"===i.type&&(s=!1)}T.tempCompanionAd&&s&&o.creatives.push(T.tempCompanionAd),k.ads.splice(r,0,o)}return delete T.nextWrapperURL,y(v)}))}(r);return y()}))},h.childByName=function(e,t){for(var i,n=e.childNodes,r=0,s=n.length;r<s;r++)if((i=n[r]).nodeName===t)return i},h.childsByName=function(e,t){for(var i,n=[],r=e.childNodes,s=0,o=r.length;s<o;s++)(i=r[s]).nodeName===t&&n.push(i);return n},h.parseAdElement=function(e){for(var t,i,n=e.childNodes,r=0,s=n.length;r<s;r++)if("Wrapper"===(i=(t=n[r]).nodeName)||"InLine"===i){if(t.setAttribute("id",e.getAttribute("id")),"Wrapper"===t.nodeName)return this.parseWrapperElement(t);if("InLine"===t.nodeName)return this.parseInLineElement(t)}},h.parseWrapperElement=function(e){var t,i,n,r,s,o=this.parseInLineElement(e),a=this.childByName(e,"VASTAdTagURI");for(null!=a?o.nextWrapperURL=this.parseNodeText(a):null!=(a=this.childByName(e,"VASTAdTagURL"))&&(o.nextWrapperURL=this.parseNodeText(this.childByName(a,"URL"))),n=0,r=(s=o.creatives).length;n<r;n++)"linear"!==(t=s[n]).type&&"nonlinear"!==t.type||null!=(i=t)&&(null!=i.trackingEvents&&(o.trackingEvents=i.trackingEvents),null!=i.videoClickTrackingURLTemplates&&(o.videoClickTrackingURLTemplates=i.videoClickTrackingURLTemplates)),"companion"===t.type&&(o.tempCompanionAd=t);if(null!=o.nextWrapperURL)return o},h.parseInLineElement=function(e){var t,i,n,r,s,o,a,l,h,u,c,p,d,f,m,g=new v;for(g.id="function"==typeof e.getAttribute&&e.getAttribute("id"),a=0,u=(d=e.childNodes).length;a<u;a++)switch((s=d[a]).nodeName){case"Error":g.errorURLTemplates.push(this.parseNodeText(s));break;case"Impression":g.impressionURLTemplates.push(this.parseNodeText(s));break;case"Survey":(o=new T).type=s.getAttribute("type"),o.url=this.parseNodeText(s),g.surveys.push(o);break;case"Creatives":for(l=0,c=(f=this.childsByName(s,"Creative")).length;l<c;l++)for(n=f[l],t=this.storeNodeAttributes(n),h=0,p=(m=n.childNodes).length;h<p;h++)switch((r=m[h]).nodeName){case"Linear":(i=this.parseCreativeLinearElement(r))&&(i.attributes=t,g.creatives.push(i));break;case"NonLinearAds":(i=this.parseNonLinear(r))&&(i.attributes=t,g.creatives.push(i));break;case"CompanionAds":(i=this.parseCompanionAd(r))&&(i.attributes=t,g.creatives.push(i))}break;case"Extensions":this.parseExtension(g.extensions,this.childsByName(s,"Extension"))}return g},h.parseChildren=function(e,t){for(var i,n,r=e.childNodes,s=[],o=0,a=r.length;o<a;o++)"#text"!==(i=r[o]).nodeName?((n=new l(i.nodeName,this.parseNodeText(i))).attributes=this.storeNodeAttributes(i),n?(t.children.push(n),null!=i.childNodes?s.push(this.parseChildren(i,n)):s.push(void 0)):s.push(void 0)):s.push(void 0);return s},h.parseExtension=function(e,t){for(var i,n,r=[],s=0,o=t.length;s<o;s++)i=t[s],(n=new a).attributes=this.storeNodeAttributes(i),this.parseChildren(i,n),r.push(e.push(n));return r},h.storeNodeAttributes=function(e){var t,i,n,r,s={};if(e.attributes)for(i=0,n=(r=e.attributes).length;i<n;i++)s[(t=r[i]).nodeName]=t.nodeValue;return s},h.parseCreativeLinearElement=function(e){var t,i,n,r,s,o,a,l,h,u,c,p,d,f,m,g,v,T,y,k,L,R,x,N,w,C,A,b,U,E,_,I,B,D,O,S,M,F,P,V,W,H,q,X,j,G,Q,Y,z,J,K,Z,$,ee,te,ie,ne,re,se=new oe;if(se.duration=this.parseDuration(this.parseNodeText(this.childByName(e,"Duration"))),-1===se.duration&&"Wrapper"!==e.parentNode.parentNode.parentNode.nodeName)return null;if(null==(y=e.getAttribute("skipoffset"))?se.skipDelay=null:"%"===y.charAt(y.length-1)?(v=parseInt(y,10),se.skipDelay=se.duration*(v/100)):se.skipDelay=this.parseDuration(y),null!=(N=this.childByName(e,"VideoClicks"))){for(se.videoClickThroughURLTemplate=this.parseNodeText(this.childByName(N,"ClickThrough")),C=0,E=(Q=this.childsByName(N,"ClickTracking")).length;C<E;C++)i=Q[C],se.videoClickTrackingURLTemplates.push(this.parseNodeText(i));for(A=0,_=(Y=this.childsByName(N,"CustomClick")).length;A<_;A++)n=Y[A],se.videoCustomClickURLTemplates.push(this.parseNodeText(n))}for(null!=(t=this.childByName(e,"AdParameters"))&&(se.adParameters=this.parseNodeText(t)),b=0,B=(J=this.childsByName(e,"TrackingEvents")).length;b<B;b++)for(R=J[b],U=0,D=(K=this.childsByName(R,"Tracking")).length;U<D;U++)if(r=(L=K[U]).getAttribute("event"),x=this.parseNodeText(L),null!=r&&null!=x){if("progress"===r){if(!(g=L.getAttribute("offset")))continue;r="%"===g.charAt(g.length-1)?"progress-"+g:"progress-"+Math.round(this.parseDuration(g))}null==(w=se.trackingEvents)[r]&&(w[r]=[]),se.trackingEvents[r].push(x)}for(W=0,O=(Z=this.childsByName(e,"MediaFiles")).length;W<O;W++)for(m=Z[W],H=0,S=($=this.childsByName(m,"MediaFile")).length;H<S;H++)f=$[H],(d=new le).id=f.getAttribute("id"),d.fileURL=this.parseNodeText(f),d.deliveryType=f.getAttribute("delivery"),d.codec=f.getAttribute("codec"),d.mimeType=f.getAttribute("type"),d.apiFramework=f.getAttribute("apiFramework"),d.bitrate=parseInt(f.getAttribute("bitrate")||0),d.minBitrate=parseInt(f.getAttribute("minBitrate")||0),d.maxBitrate=parseInt(f.getAttribute("maxBitrate")||0),d.width=parseInt(f.getAttribute("width")||0),d.height=parseInt(f.getAttribute("height")||0),(T=f.getAttribute("scalable"))&&"string"==typeof T&&("true"===(T=T.toLowerCase())?d.scalable=!0:"false"===T&&(d.scalable=!1)),(p=f.getAttribute("maintainAspectRatio"))&&"string"==typeof p&&("true"===(p=p.toLowerCase())?d.maintainAspectRatio=!0:"false"===p&&(d.maintainAspectRatio=!1)),se.mediaFiles.push(d);if(null!=(u=this.childByName(e,"Icons")))for(q=0,M=(ee=this.childsByName(u,"Icon")).length;q<M;q++){for(h=ee[q],(o=new ae).program=h.getAttribute("program"),o.height=parseInt(h.getAttribute("height")||0),o.width=parseInt(h.getAttribute("width")||0),o.xPosition=this.parseXPosition(h.getAttribute("xPosition")),o.yPosition=this.parseYPosition(h.getAttribute("yPosition")),o.apiFramework=h.getAttribute("apiFramework"),o.offset=this.parseDuration(h.getAttribute("offset")),o.duration=this.parseDuration(h.getAttribute("duration")),X=0,F=(te=this.childsByName(h,"HTMLResource")).length;X<F;X++)s=te[X],o.type=s.getAttribute("creativeType")||"text/html",o.htmlResource=this.parseNodeText(s);for(j=0,P=(ie=this.childsByName(h,"IFrameResource")).length;j<P;j++)c=ie[j],o.type=c.getAttribute("creativeType")||0,o.iframeResource=this.parseNodeText(c);for(G=0,V=(ne=this.childsByName(h,"StaticResource")).length;G<V;G++)k=ne[G],o.type=k.getAttribute("creativeType")||0,o.staticResource=this.parseNodeText(k);if(null!=(l=this.childByName(h,"IconClicks")))for(o.iconClickThroughURLTemplate=this.parseNodeText(this.childByName(l,"IconClickThrough")),re=0,I=(z=this.childsByName(l,"IconClickTracking")).length;re<I;re++)a=z[re],o.iconClickTrackingURLTemplates.push(this.parseNodeText(a));o.iconViewTrackingURLTemplate=this.parseNodeText(this.childByName(h,"IconViewTracking")),se.icons.push(o)}return se},h.parseNonLinear=function(e){for(var t,i,n,r,s,o,a,l,h,u,c,p,d,f,m,g,v,T,y,k,L,R,x,N,w,C=new I,A=this.childsByName(e,"TrackingEvents"),b=0,U=A.length;b<U;b++)for(l=A[b],c=0,f=(L=this.childsByName(l,"Tracking")).length;c<f;c++)t=(a=L[c]).getAttribute("event"),h=this.parseNodeText(a),null!=t&&null!=h&&(null==(u=C.trackingEvents)[t]&&(u[t]=[]),C.trackingEvents[t].push(h));for(p=0,m=(R=this.childsByName(e,"NonLinear")).length;p<m;p++){for(s=R[p],(r=new B).id=s.getAttribute("id")||null,r.width=s.getAttribute("width"),r.height=s.getAttribute("height"),r.minSuggestedDuration=s.getAttribute("minSuggestedDuration"),r.apiFramework=s.getAttribute("apiFramework"),d=0,g=(x=this.childsByName(s,"HTMLResource")).length;d<g;d++)i=x[d],r.type=i.getAttribute("creativeType")||"text/html",r.htmlResource=this.parseNodeText(i);for(y=0,v=(N=this.childsByName(s,"IFrameResource")).length;y<v;y++)n=N[y],r.type=n.getAttribute("creativeType")||0,r.iframeResource=this.parseNodeText(n);for(k=0,T=(w=this.childsByName(s,"StaticResource")).length;k<T;k++)o=w[k],r.type=o.getAttribute("creativeType")||0,r.staticResource=this.parseNodeText(o);r.nonlinearClickThroughURLTemplate=this.parseNodeText(this.childByName(s,"NonLinearClickThrough")),C.variations.push(r)}return C},h.parseCompanionAd=function(e){for(var t,i,n,r,s,o,a,l,h,u,c,p,d,f,m,g,v,T,y,k,L,R,x,N,w,C=new _,A=this.childsByName(e,"Companion"),b=0,U=A.length;b<U;b++){for(i=A[b],(t=new E).id=i.getAttribute("id")||null,t.width=i.getAttribute("width"),t.height=i.getAttribute("height"),c=0,f=(L=this.childsByName(i,"HTMLResource")).length;c<f;c++)r=L[c],t.type=r.getAttribute("creativeType")||"text/html",t.htmlResource=this.parseNodeText(r);for(p=0,m=(R=this.childsByName(i,"IFrameResource")).length;p<m;p++)s=R[p],t.type=s.getAttribute("creativeType")||0,t.iframeResource=this.parseNodeText(s);for(d=0,g=(x=this.childsByName(i,"StaticResource")).length;d<g;d++)o=x[d],t.type=o.getAttribute("creativeType")||0,t.staticResource=this.parseNodeText(o);for(y=0,v=(N=this.childsByName(i,"TrackingEvents")).length;y<v;y++)for(l=N[y],k=0,T=(w=this.childsByName(l,"Tracking")).length;k<T;k++)n=(a=w[k]).getAttribute("event"),h=this.parseNodeText(a),null!=n&&null!=h&&(null==(u=t.trackingEvents)[n]&&(u[n]=[]),t.trackingEvents[n].push(h));t.companionClickThroughURLTemplate=this.parseNodeText(this.childByName(i,"CompanionClickThrough")),t.companionClickTrackingURLTemplate=this.parseNodeText(this.childByName(i,"CompanionClickTracking")),C.variations.push(t)}return C},h.parseDuration=function(e){var t,i,n,r,s;return null==e||3!==(t=e.split(":")).length?-1:(s=t[2].split("."),r=parseInt(s[0]),2===s.length&&(r+=parseFloat("0."+s[1])),n=parseInt(60*t[1]),i=parseInt(60*t[0]*60),isNaN(i||isNaN(n||isNaN(r||3600<n||60<r)))?-1:i+n+r)},h.parseXPosition=function(e){var t;return"left"===(t=e.toLowerCase())||"right"===t?e:parseInt(e||0)},h.parseYPosition=function(e){var t;return"top"===(t=e.toLowerCase())||"bottom"===t?e:parseInt(e||0)},h.parseNodeText=function(e){return e&&(e.textContent||e.text||"").trim()},t.exports=h},{"./ad":2,"./companionad":4,"./creative":5,"./extension":6,"./extensionchild":7,"./icon":8,"./mediafile":10,"./nonlinear":11,"./response":13,"./survey":14,"./urlhandler":16,"./util":19,events:1}],13:[function(e,t,i){var n=function(){this.ads=[],this.errorURLTemplates=[]};t.exports=n},{}],14:[function(e,t,i){var n=function(){this.type=null,this.url=null};t.exports=n},{}],15:[function(e,t,i){var s,o,n,r={}.hasOwnProperty;function a(e,t){var i,n,r;for(i in this.ad=e,this.creative=t,this.muted=!1,this.impressed=!1,this.skipable=!1,this.skipDelayDefault=-1,this.trackingEvents={},this.emitAlwaysEvents=["creativeView","start","firstQuartile","midpoint","thirdQuartile","complete","resume","pause","rewind","skip","closeLinear","close"],r=this.creative.trackingEvents)n=r[i],this.trackingEvents[i]=n.slice(0);this.creative instanceof o?(this.setDuration(this.creative.duration),this.skipDelay=this.creative.skipDelay,this.linear=!0,this.clickThroughURLTemplate=this.creative.videoClickThroughURLTemplate,this.clickTrackingURLTemplates=this.creative.videoClickTrackingURLTemplates):(this.skipDelay=-1,this.linear=!1),this.on("start",function(){s.lastSuccessfullAd=+new Date})}s=e("./client"),n=e("./util"),o=e("./creative").VASTCreativeLinear,function(e,t){for(var i in t)r.call(t,i)&&(e[i]=t[i]);function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype}(a,e("events").EventEmitter),a.prototype.setDuration=function(e){return this.assetDuration=e,this.quartiles={firstQuartile:Math.round(25*this.assetDuration)/100,midpoint:Math.round(50*this.assetDuration)/100,thirdQuartile:Math.round(75*this.assetDuration)/100}},a.prototype.setProgress=function(e){var t,i,n,r,s,o,a,l,h=null===this.skipDelay?this.skipDelayDefault:this.skipDelay;if(-1===h||this.skipable||(e<h?this.emit("skip-countdown",h-e):(this.skipable=!0,this.emit("skip-countdown",0))),this.linear&&0<this.assetDuration){if(i=[],0<e)for(r in i.push("start"),n=Math.round(e/this.assetDuration*100),i.push("progress-"+n+"%"),i.push("progress-"+Math.round(e)),l=this.quartiles)(s=l[r])<=e&&e<=s+1&&i.push(r);for(o=0,a=i.length;o<a;o++)t=i[o],this.track(t,!0);e<this.progress&&this.track("rewind")}return this.progress=e},a.prototype.setMuted=function(e){return this.muted!==e&&this.track(e?"mute":"unmute"),this.muted=e},a.prototype.setPaused=function(e){return this.paused!==e&&this.track(e?"pause":"resume"),this.paused=e},a.prototype.setFullscreen=function(e){return this.fullscreen!==e&&this.track(e?"fullscreen":"exitFullscreen"),this.fullscreen=e},a.prototype.setSkipDelay=function(e){if("number"==typeof e)return this.skipDelay=e},a.prototype.load=function(){if(!this.impressed)return this.impressed=!0,this.trackURLs(this.ad.impressionURLTemplates),this.track("creativeView")},a.prototype.errorWithCode=function(e){return this.trackURLs(this.ad.errorURLTemplates,{ERRORCODE:e})},a.prototype.complete=function(){return this.track("complete")},a.prototype.close=function(){return this.track(this.linear?"closeLinear":"close")},a.prototype.stop=function(){},a.prototype.skip=function(){return this.track("skip"),this.trackingEvents=[]},a.prototype.click=function(){var e,t,i;if(null!=(i=this.clickTrackingURLTemplates)&&i.length&&this.trackURLs(this.clickTrackingURLTemplates),null!=this.clickThroughURLTemplate)return this.linear&&(t={CONTENTPLAYHEAD:this.progressFormated()}),e=n.resolveURLTemplates([this.clickThroughURLTemplate],t)[0],this.emit("clickthrough",e)},a.prototype.track=function(e,t){var i,n;null==t&&(t=!1),"closeLinear"===e&&null==this.trackingEvents[e]&&null!=this.trackingEvents.close&&(e="close"),n=this.trackingEvents[e],i=this.emitAlwaysEvents.indexOf(e),null!=n?(this.emit(e,""),this.trackURLs(n)):-1!==i&&this.emit(e,""),!0===t&&(delete this.trackingEvents[e],-1<i&&this.emitAlwaysEvents.splice(i,1))},a.prototype.trackURLs=function(e,t){return null==t&&(t={}),this.linear&&(t.CONTENTPLAYHEAD=this.progressFormated()),n.track(e,t)},a.prototype.progressFormated=function(){var e,t,i=parseInt(this.progress),n=i/3600;return n.length<2&&(n="0"+n),(e=i/60%60).length<2&&(e="0"+e),(t=i%60).length<2&&(t="0"+e),n+":"+e+":"+t+"."+parseInt(100*(this.progress-i))},t.exports=a},{"./client":3,"./creative":5,"./util":19,events:1}],16:[function(r,e,t){var s,o;function i(){}o=r("./urlhandlers/xmlhttprequest"),s=r("./urlhandlers/flash"),i.get=function(e,t,i){var n;return i||("function"==typeof t&&(i=t),t={}),null!=t.response?i(null,t.response):null!=(n=t.urlhandler)&&n.supported()?t.urlhandler.get(e,t,i):"undefined"==typeof window||null===window?r("./urlhandlers/node").get(e,t,i):o.supported()?o.get(e,t,i):s.supported()?s.get(e,t,i):i()},e.exports=i},{"./urlhandlers/flash":17,"./urlhandlers/xmlhttprequest":18}],17:[function(e,t,i){function n(){}n.xdr=function(){var e;return window.XDomainRequest&&(e=new XDomainRequest),e},n.supported=function(){return!!this.xdr()},n.get=function(e,t,i){var n,r;return(r="function"==typeof window.ActiveXObject?new window.ActiveXObject("Microsoft.XMLDOM"):void 0)?(r.async=!1,(n=this.xdr()).open("GET",e),n.timeout=t.timeout||0,n.withCredentials=t.withCredentials||!1,n.send(),n.onprogress=function(){},n.onload=function(){return r.loadXML(n.responseText),i(null,r)}):i()},t.exports=n},{}],18:[function(e,t,i){function n(){}n.xhr=function(){var e=new window.XMLHttpRequest;if("withCredentials"in e)return e},n.supported=function(){return!!this.xhr()},n.get=function(e,t,i){var n;if("https:"===window.location.protocol&&0===e.indexOf("http://"))return i(new Error("Cannot go from HTTPS to HTTP."));try{return(n=this.xhr()).open("GET",e),n.timeout=t.timeout||0,n.withCredentials=t.withCredentials||!1,n.overrideMimeType&&n.overrideMimeType("text/xml"),n.onreadystatechange=function(){if(4===n.readyState)return i(null,n.responseXML)},n.send()}catch(e){return i()}},t.exports=n},{}],19:[function(e,t,i){function n(){}n.track=function(e,t){for(var i,n,r=this.resolveURLTemplates(e,t),s=[],o=0,a=r.length;o<a;o++)i=r[o],"undefined"!=typeof window&&null!==window&&(n=new Image,s.push(n.src=i));return s},n.resolveURLTemplates=function(e,t){var i,n,r,s,o,a,l,h=[];null==t&&(t={}),"CACHEBUSTING"in t||(t.CACHEBUSTING=Math.round(1e10*Math.random())),t.random=t.CACHEBUSTING;for(a=0,l=e.length;a<l;a++)if(s=e[a]){for(i in t)o=t[i],n="["+i+"]",r="%%"+i+"%%",s=(s=s.replace(n,o)).replace(r,o);h.push(s)}return h},n.storage=function(){var i,t;try{t="undefined"!=typeof window&&null!==window?window.localStorage||window.sessionStorage:null}catch(e){t=null}return null!=t&&!function(e){var t;try{if(t="__VASTUtil__",e.setItem(t,t),e.getItem(t)!==t)return!0}catch(e){return!0}return!1}(t)||(i={},t={length:0,getItem:function(e){return i[e]},setItem:function(e,t){i[e]=t,this.length=Object.keys(i).length},removeItem:function(e){delete i[e],this.length=Object.keys(i).length},clear:function(){i={},this.length=0}}),t}(),t.exports=n},{}]},{},[9])(9)},"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):("undefined"!=typeof window?n=window:"undefined"!=typeof global?n=global:"undefined"!=typeof self&&(n=self),n.DMVAST=e())}catch(e){try{var t=e.name+" in global t/c: "+e.message+", stack="+e.stack,i="//px.moatads.com/pixel.gif?e=24&d=data%3Adata%3Adata%3Adata&i="+encodeURIComponent("SPECTRUMREACHVPAID1")+"&ac=1&k="+encodeURIComponent(t)+"&ar="+encodeURIComponent("97b82f9bf7-clean")+"&iw="+encodeURIComponent("eefd067")+"&j="+encodeURIComponent(document.referrer)+"&cs="+(new Date).getTime();(new Image).src=i}catch(e){}}var e,n}();

